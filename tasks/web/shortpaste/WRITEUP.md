Читаем описание таска, понимаем что перед нами что-то грандиозное и ранее невиданное - сервис для коротких паст. Переходим по-ссылке, видим подтверждение ранее прочитанному, дизаин и правда невероятный, а ник реально "хайпово сгенерируется".
<img src="https://user-images.githubusercontent.com/24609869/203990819-3fb7efb7-df83-4e61-9b01-c1a3c91da2af.png" width=500px/>  
Пробуем авторизоваться, создать пасту, всё работает, начинаем искать уязвимость.  

Для начала обратим внимание, на интересную механику генерации ников, каждый новый юзер получает ник "HypeUser_N", где N - порядковый номер зарегистрированного юзера.  
![Screenshot 2022-11-25 at 16 03 13](https://user-images.githubusercontent.com/24609869/203991654-930c2c4f-d89f-4827-8275-34fe0fdafd73.png)    
Думаем, как можно это использовать... Придумали? Вот и я тоже не придумал.  

Едем дальше, вспоминаем про ограничение в 140 символов:  
<img src="https://user-images.githubusercontent.com/24609869/203991954-85c76ea2-daed-49b8-93af-243e1a462c84.png" width="400px"/>  
Думаем, как можно это использовать... Придумали? Вот и я тоже не придумал.  

Далее, замечаем интересную деталь, когда мы кликаем по созданной пасте, нас перенаправляет на ссылку ввида `/paste/<base64>`, где `<base64>`, какой-то base64, пробуем раздекодить. Так-как это base64 используется в url, значит некоторые символы, типа `/` и `+` в нем заменяются, поэтому декодим через Base64URL декодер.  
Для заметки с названием `lol` и содержимым `kek`, получаем такое:  
![Screenshot 2022-11-25 at 16 10 07](https://user-images.githubusercontent.com/24609869/203992700-099c2aee-6a37-4240-bcc2-dc95a506a03f.png)  
Очевидно, это какие-то байты, крутим их вертим, ничего адекватного не получаем. Опять не то(((  

Проехали, заглянем в куки, увидим интересный кук `auth`, равный чему-то в base64 с точками. Тут либо знаем, либо гуглим и узнаём, что это JWT. 
Кидаем этот JWT токен в декодер [jwt.io](https://jwt.io/):  
![Screenshot 2022-11-25 at 16 13 59](https://user-images.githubusercontent.com/24609869/203993343-4b27233b-ab90-4955-b24f-9442a3f4bca7.png)  

Видим интересное, в jwt токене хранится id юзера, пробуем его поменять на, например, `"id": 1`, кодируем, вставляем в куку и вуаля... Нас выбрасывает на страницу авторизации.
Пытаемся выяснить, что же не так, читаем про структуру JWT, узнаем что оказывается, точками разделяются части токена, первая часть - метаданные о используемом алгоритме и типе токена, вторая - содержимое, третья - подпись токена, использующаяся для подтверждения подлинности.  

Обращаем внимание на последнюю часть, на подпись. Узнаем, что `HS256` - это `HMAC-SHA256`, алгоритм генерации подписи с помощью секретного ключа.
На [jwt.io](https://jwt.io/) замечаем поле `VERIFY SIGNATURE`, в котором написано каким образом генерируется подпись:  
![Screenshot 2022-11-25 at 16 19 58](https://user-images.githubusercontent.com/24609869/203994292-3ef3799e-0127-447c-876d-4384e31327fb.png)  
Понимаем, что для того что-бы подменить токен, нам нужно знать secret. Гуглим, пытаемся узнать, как его можно вычислить, находим статью типа [такой](https://blog.pentesteracademy.com/hacking-jwt-tokens-bruteforcing-weak-signing-key-hashcat-7dba165e905e), в которой узнаем, что hashcat умеет ломать jwt. Можем попробовать использовать брутфорс в лоб из статьи, но вскоре мы поймем, что это не работает, поэтому гуглим дальше и узнаем о том, что hashcat умеет в атаку по словарю. Гуглим словарь популярных jwt секретов, либо популярных паролей. 

Можно было использовать всем известный [rockyou.txt](https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt), либо [jwt.secrets.list](https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list)(первая строчка при запросе `jwt secrets`).  
Запускаем хэшкэт(команда есть на скрине) и достаточно быстр взламываем секрет(у меня заняло меньше секунды):  
![Screenshot 2022-11-25 at 16 30 12](https://user-images.githubusercontent.com/24609869/203996127-0baa6f31-beb2-4fb5-a8b4-783c1351f74a.png)

Красная стрелка указывает на подобранный секрет.
Далее, вставляем этот секрет в поле `your-256-bit-secret` с сайта [jwt.io](https://jwt.io/) и подменяем id на `1`. Вставляем сгенерированный JWT в куку `auth`, получаем доступ к первому юзеру и находим у него пасту с названием `NE FLAG`, открываем её, получаем флаг.  
![Screenshot 2022-11-25 at 16 33 48](https://user-images.githubusercontent.com/24609869/203996691-728d7fb3-ddbc-4578-8327-fcf26a8581de.png)
![Screenshot 2022-11-25 at 16 33 57](https://user-images.githubusercontent.com/24609869/203996700-431fa3f9-eea3-47a0-b47b-82dd361fc872.png)

`flag: surctf_jwt_is_rly_hyped_th1ng_swagXD`
